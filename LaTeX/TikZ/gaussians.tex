% Author: Izaak Neutelings (August, 2017)

\documentclass[border=3pt,tikz]{standalone} %[dvipsnames]

\usepackage{amsmath} % for \dfrac
\usepackage{tikz}
\tikzset{>=latex} % for LaTeX arrow head
\usepackage{pgfplots} % for the axis environment
\usepackage{xcolor}
\usetikzlibrary{positioning,calc}

% define gaussian pdf and cdf
\pgfmathdeclarefunction{gauss}{3}{%
  \pgfmathparse{1/(#3*sqrt(2*pi))*exp(-((#1-#2)^2)/(2*#3^2))}%
}
\pgfmathdeclarefunction{cdf}{3}{%
  \pgfmathparse{1/(1+exp(-0.07056*((#1-#2)/#3)^3 - 1.5976*(#1-#2)/#3))}%
}

% to fill an area under function
\usepgfplotslibrary{fillbetween}
\usetikzlibrary{patterns}
\pgfplotsset{compat=1.12} % TikZ coordinates <-> axes coordinates
% https://tex.stackexchange.com/questions/240642/add-vertical-line-of-equation-x-2-and-shade-a-region-in-graph-by-pgfplots

% plot aspect ratio
%\def\axisdefaultwidth{8cm}
%\def\axisdefaultheight{6cm}

% number of sample points
\def\N{40}

\begin{document}



% GAUSSIANs: confidence level
\begin{tikzpicture}
  
  \def\q{13.8};
  \def\B{8.5};
  \def\S{18.5};
  \def\Bs{2.60};
  \def\Ss{3.40};
  \def\xmax{\S+3.2*\Ss};
  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
  
  \begin{axis}[every axis plot post/.append style={
               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
               xmin={-0.1*(\xmax)}, xmax=\xmax,
               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
               axis lines=middle,
               axis line style=thick,
               %axis x line=bottom,  % no box around the plot, only x and y axis
               %axis y line=left,    % ...line*=... suppresses the arrow tips
               enlargelimits=upper, % extend the axes a bit to the right and top
               ticks=none,
               xlabel=$x$,
               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
               y=600pt
              ]
    
    % plots
    \addplot[name path=B,thick,black!10!blue] {gauss(x,\B,\Bs)};
    \addplot[name path=S,thick,black!10!red ] {gauss(x,\S,\Ss)};
    \addplot[black,dashed,thick]
      coordinates {(\q, {0.95*gauss(\B,\B,\Bs)}) (\q, \ymin)}
      node[below=2pt,anchor=south west] {$x_\text{cut}$};
    \draw[->,thick]
      (\q,{0.90*gauss(\B,\B,\Bs)}) -- ({\q+1.6*\Ss},{0.90*gauss(\B,\B,\Bs)})
      node[above=4pt] {\footnotesize\qquad\qquad\qquad CRITICAL REGION};
    
    % fill
    \path[name path=xaxis]
      (0,0) -- (\xmax,0); % \pgfkeysvalueof{/pgfplots/xmin}
    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=0:\q}];
    
    % labels
    \node[above=2pt,  black!20!blue] at (       \B,      {gauss(\B,\B,\Bs)})     {$f(x|H_0)$};
    \node[above right,black!20!red ] at ({1.05*(\S+\Ss)},{gauss(\S+\Ss,\S,\Ss)}) {$f(x|H_1)$};
    \node[above left, black!20!red ] at ({0.8*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$\beta$};
    \node[above right,black!20!blue] at ({1.1*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$\alpha$};
    \node[below=2pt] at ($(0,0)!0.5!(\q,0)$)     {ACCEPT};
    \node[below=2pt] at ($(\q,0)!0.5!(\xmax,0)$) {\quad REJECT};
    
  \end{axis}
\end{tikzpicture}



%% GAUSSIANs: test statistics
%\begin{tikzpicture}
%  
%  \def\q{13.8};
%  \def\B{8.5};
%  \def\S{18.5};
%  \def\Bs{2.60};
%  \def\Ss{3.40};
%  \def\xmax{\S+3.2*\Ss};
%  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
%  
%  \begin{axis}[every axis plot post/.append style={
%               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
%               xmin={-0.1*(\xmax)}, xmax=\xmax,
%               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
%               axis lines=middle,
%               axis line style=thick,
%               %axis x line=bottom,  % no box around the plot, only x and y axis
%               %axis y line=left,    % ...line*=... suppresses the arrow tips
%               enlargelimits=upper, % extend the axes a bit to the right and top
%               ticks=none,
%               xlabel=$t$,
%               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
%               width=0.7*\textwidth, height=0.5*\textwidth,
%               %y=100pt
%              ]
%    
%    % plots
%    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
%    \addplot[red,  name path=S,thick] {gauss(x,\S,\Ss)};
%    \addplot[black,dashed,thick]
%      coordinates {(\q, {0.95*gauss(\B,\B,\Bs)}) (\q, \ymin)}
%      node[below=3pt,anchor=south west] {$t_\text{cut}$};
%    
%    % fill
%    \path[name path=xaxis]
%      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
%    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
%    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=0:\q}];
%    
%    % labels
%    \node[above=2pt,  black!20!blue] at (   \B,  {gauss(\B,\B,\Bs)}) {$f(t|H_0)$};
%    \node[above right,black!20!red]  at (1.05*\S,{gauss(\S,\S,\Ss)}) {$f(t|H_1)$};
%    \node[below=2pt] at ($(0,0)!0.5!(\q,0)$)     {ACCEPT};
%    \node[below=2pt] at ($(\q,0)!0.5!(\xmax,0)$) {\quad REJECT};
%    %\path[name path=xaxis] (0,0) -- (\q,0) node[midway] {ACCEPT};
%    
%  \end{axis}
%\end{tikzpicture}



% GAUSSIANs: test statistics
\begin{tikzpicture}
  
  \def\q{13.0};
  \def\B{ 9.0};
  \def\S{19.0};
  \def\Bs{2.6};
  \def\Ss{3.0};
  \def\xmax{\S+3.2*\Ss};
  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
  
  \begin{axis}[every axis plot post/.append style={
               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
               xmin={-0.1*(\xmax)}, xmax=\xmax,
               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
               axis lines=middle,
               axis line style=thick,
               enlargelimits=upper, % extend the axes a bit to the right and top
               ticks=none,
               xlabel=$x$,
               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
               width=0.7*\textwidth, height=0.4*\textwidth,
               clip=false, % prevent labels falling off
              ]
    
    % plots
    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
    \addplot[red,  name path=S,thick] {gauss(x,\S,\Ss)};
    \addplot[black,dashed,thick]
      coordinates {(\B, {1.02*gauss(\B,\B,\Bs)}) (\B,{-0.05*gauss(\B,\B,\Bs)})}
      node[below=-4pt] {\strut$\mu_0$};
    \addplot[black,dashed,thick]
      coordinates {(\S, {1.02*gauss(\S,\S,\Ss)}) (\S,{-0.05*gauss(\S,\S,\Ss)})}
      node[below=-4pt] {\strut$\mu$};
    \addplot[black,dashed,thick]
      coordinates {(\q, {0.50*gauss(\B,\B,\Bs)}) (\q,{-0.05*gauss(\B,\B,\Bs)})}
      node[below=-4pt] {\strut$x_\text{cut}$};
    
    % fill
    \path[name path=xaxis]
      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=0:\q}];
    
    % labels
    \node[above=2pt,black!20!blue] at (   \B,  {gauss(\B,\B,\Bs)}) {$\mathcal{N}(\mu_0,\sigma)$};
    \node[above=2pt,black!20!red]  at (1.05*\S,{gauss(\S,\S,\Ss)}) {$\mathcal{N}(\mu,\sigma)$};
    
  \end{axis}
\end{tikzpicture}



% GAUSSIANs: cdf
\begin{tikzpicture}
  
  \def\q{13.0};
  \def\B{ 9.0};
  \def\S{19.0};
  \def\Bs{2.6};
  \def\Ss{3.0};
  \def\xmax{\S+3.2*\Ss};
  \def\ymin{-0.15};
  
  \begin{axis}[every axis plot post/.append style={
               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
               xmin={-0.1*(\xmax)}, xmax=\xmax,
               ymin=\ymin, ymax={1.05*cdf(\xmax,\B,\Bs)},
               axis lines=middle,
               axis line style=thick,
               enlargelimits=upper, % extend the axes a bit to the right and top
               ticks=none,
               xlabel=$\mu$,
               ylabel={power},
               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
               %every axis y label/.style={anchor=north west},
               width=0.7*\textwidth, height=0.4*\textwidth,
               clip=false, % prevent labels falling off
              ]
    
    % plots
    %\addplot[name path=B,thick,black!10!blue] {cdf(x,\B,\Bs)};
    \addplot[name path=B,thick,black!10!red]  {1-cdf(\q,x,\Ss)};
    \addplot[black,dashed,thick]
      coordinates {(\B,{1-cdf(\q,\B,\Ss)}) (\B,-0.05)}
      node[below=-5pt] {\strut$\mu_0$};
    \addplot[black,dashed,thick]
      coordinates {(\B,{1-cdf(\q,\B,\Ss)}) (0,{1-cdf(\q,\B,\Ss)})}
      node[left=0pt] {\strut$\alpha$};
    
  \end{axis}
\end{tikzpicture}




%% GAUSSIANs: low sensitivity 1
%\begin{tikzpicture}
%  
%  \def\q{5.5};
%  \def\B{-1.0};
%  \def\S{-1.0};
%  \def\Bs{3.00};
%  \def\Ss{3.40};
%  \def\xmax{\S+3.2*\Ss};
%  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
%  
%  \begin{axis}[every axis plot post/.append style={
%               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
%               xmin={-0.1*(\xmax)}, xmax=\xmax,
%               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
%               axis lines=middle,
%               axis line style=thick,
%               %axis x line=bottom,  % no box around the plot, only x and y axis
%               %axis y line=left,    % ...line*=... suppresses the arrow tips
%               enlargelimits=upper, % extend the axes a bit to the right and top
%               ticks=none,
%               xlabel=$q_\mu$,
%               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
%               width=0.7*\textwidth, height=0.5*\textwidth,
%               %y=100pt
%              ]
%    
%    % plots
%    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
%    \addplot[red,  name path=S,thick] {gauss(x,\S,\Ss)};
%    \addplot[black,dashed,thick]
%      coordinates {(\q, {0.95*gauss(\B,\B,\Bs)}) (\q, \ymin)};
%      %node[below=2pt,anchor=south west] {$q_\text{obs}$};
%    \draw[->,thick]
%      (\q,{0.7*gauss(\B,\B,\Bs)}) -- ({\q+0.5*\Ss},{0.7*gauss(\B,\B,\Bs)})
%      node[below=8pt,align=center] {\qquad CRITICAL\\\qquad REGION};
%    
%    % fill
%    \path[name path=xaxis]
%      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
%    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=\q:\xmax}];
%    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
%    
%    % labels
%    \node[above right=2pt,     black!20!blue]
%      at (    0,       {gauss(0,\B,\Bs)})       {$f(q_0|0)$};
%    \node[above right=2pt, black!20!red,align=center]
%      at ({\S+2.4*\Ss},{gauss(\S+2.4*\Ss,\S,\Ss)}) {$f(q_\mu|0)$};
%    %\node[above left, black!20!red ] at ({0.8*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{s+b}$};
%    %\node[above right,black!20!blue] at ({1.1*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{b}$};
%    
%  \end{axis}
%\end{tikzpicture}
%
%
%
%% GAUSSIANs: low sensitivity 2
%\begin{tikzpicture}
%  
%  \def\q{17.0};
%  \def\B{-1.0};
%  \def\S{18.0};
%  \def\Bs{10.0};
%  \def\Ss{8.0};
%  \def\xmax{\S+3.2*\Ss};
%  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
%  
%  \begin{axis}[every axis plot post/.append style={
%               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
%               xmin={-0.1*(\xmax)}, xmax=\xmax,
%               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
%               axis lines=middle,
%               axis line style=thick,
%               %axis x line=bottom,  % no box around the plot, only x and y axis
%               %axis y line=left,    % ...line*=... suppresses the arrow tips
%               enlargelimits=upper, % extend the axes a bit to the right and top
%               ticks=none,
%               xlabel=$q_\mu$,
%               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
%               width=0.7*\textwidth, height=0.5*\textwidth,
%               %y=100pt
%              ]
%    
%    % plots
%    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
%    \addplot[red,  name path=S,thick] {0.5*gauss(x,\S,\Ss)};
%    \addplot[black,dashed,thick]
%      coordinates {(\q, {gauss(\B,\B,\Bs)}) (\q, \ymin)};
%    \draw[->,thick]
%      (\q,{0.9*gauss(\B,\B,\Bs)}) -- ({\q+\Ss},{0.9*gauss(\B,\B,\Bs)})
%      node[below right=4pt,align=center] {CRITICAL\\REGION};
%    
%    % fill
%    \path[name path=xaxis]
%      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
%    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=\q:\xmax}];
%    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
%    
%    % labels
%    \node[above right=2pt,     black!20!blue]          at (    0,    {gauss(0,\B,\Bs)})       {$f(q_0|0)$};
%    \node[above right=2pt, black!20!red,align=center]  at ({\S+1.1*\Ss},{0.5*gauss(\S+1.1*\Ss,\S,\Ss)}) {$f(q_\mu|0)$};
%    %\node[above left, black!20!red ] at ({0.8*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{s+b}$};
%    %\node[above right,black!20!blue] at ({1.1*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{b}$};
%    
%  \end{axis}
%\end{tikzpicture}
%
%
%
%% GAUSSIANs: p-value
%\begin{tikzpicture}
%  
%  \def\q{13.8};
%  \def\B{8.5};
%  \def\S{18.5};
%  \def\Bs{2.60};
%  \def\Ss{3.40};
%  \def\xmax{\S+3.2*\Ss};
%  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
%  
%  \begin{axis}[every axis plot post/.append style={
%               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
%               xmin={-0.1*(\xmax)}, xmax=\xmax,
%               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
%               axis lines=middle,
%               axis line style=thick,
%               %axis x line=bottom,  % no box around the plot, only x and y axis
%               %axis y line=left,    % ...line*=... suppresses the arrow tips
%               enlargelimits=upper, % extend the axes a bit to the right and top
%               ticks=none,
%               xlabel=$q$,
%               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
%               width=0.7*\textwidth, height=0.5*\textwidth,
%               %y=100pt
%              ]
%    
%    % plots
%    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
%    \addplot[red,  name path=S,thick] {gauss(x,\S,\Ss)};
%    \addplot[black,dashed,thick]
%      coordinates {(\q, {0.95*gauss(\B,\B,\Bs)}) (\q, \ymin)}
%      node[below=2pt,anchor=south west] {$q_\text{obs}$};
%    
%    % fill
%    \path[name path=xaxis]
%      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
%    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
%    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=0:\q}];
%    
%    % labels
%    \node[above,      black!20!blue]              at (1.12*\B,{gauss(\B,\B,\Bs)}) {$f(x|\text{b})$}; %{background only};
%    \node[above right,black!20!red,align=center]  at (1.05*\S,{gauss(\S,\S,\Ss)}) {$f(x|\text{s+b})$}; %{signal +\\background};
%    \node[above left, black!20!red ] at ({0.8*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{s+b}$};
%    \node[above right,black!20!blue] at ({1.1*\q},{gauss(1.07*\q,\B,\Bs)}) {\strut$p_\text{b}$};
%    
%  \end{axis}
%\end{tikzpicture}
%
%
%
%% GAUSSIANs: p-value - overlap
%\begin{tikzpicture}
%  
%  \def\q{6.0};
%  \def\B{10};
%  \def\S{12};
%  \def\Bs{2.6};
%  \def\Ss{3.0};
%  \def\xmax{\S+3.2*\Ss};
%  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
%  
%  \begin{axis}[every axis plot post/.append style={
%               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
%               xmin={-0.1*(\xmax)}, xmax=\xmax,
%               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
%               axis lines=middle,
%               axis line style=thick,
%               enlargelimits=upper, % extend the axes a bit to the right and top
%               ticks=none,
%               xlabel=$q$,
%               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
%               width=0.7*\textwidth, height=0.5*\textwidth,
%               %y=100pt
%              ]
%    
%    % plots
%    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
%    \addplot[red,  name path=S,thick] {gauss(x,\S,\Ss)};
%    \addplot[black,dashed,thick]
%      coordinates {(\q, {0.90*gauss(\B,\B,\Bs)}) (\q, \ymin)}
%      node[below=2pt,anchor=south west] {$q_\text{obs}$};
%    
%    % fill
%    \path[name path=xaxis]
%      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
%    \addplot[white!50!blue] fill between[of=xaxis and B, soft clip={domain=\q:\xmax}];
%    \addplot[white!50!red]  fill between[of=xaxis and S, soft clip={domain=0:\q}];
%    
%    % labels
%    \node[above left=2pt, black!20!blue] at (1.05*\B,{gauss(\B,\B,\Bs)}) {$f(x|\text{b})$};
%    \node[above right=2pt,black!20!red]  at (   \S  ,{gauss(\S,\S,\Ss)}) {$f(x|\text{s+b})$};
%    \node[above,      black!70!blue] at (   \B   ,{gauss(\q,\S,\Ss)})      {\strut$p_\text{b}$};
%    \node[above left, black!20!red ] at ({0.8*\q},{gauss(0.80*\q,\B,\Bs)}) {\strut$p_\text{s+b}$};
%    
%  \end{axis}
%\end{tikzpicture}



% GAUSSIANs: error bands
\begin{tikzpicture}
  
  \def\B{10};
  \def\Bs{3.0};
  \def\xmax{\B+3.2*\Bs};
  \def\ymin{{-0.15*gauss(\B,\B,\Bs)}};
  
  \begin{axis}[every axis plot post/.append style={
               mark=none,domain={-0.05*(\xmax)}:{1.08*\xmax},samples=\N,smooth},
               xmin={-0.1*(\xmax)}, xmax=\xmax,
               ymin=\ymin, ymax={1.1*gauss(\B,\B,\Bs)},
               axis lines=middle,
               axis line style=thick,
               enlargelimits=upper, % extend the axes a bit to the right and top
               ticks=none,
               xlabel=$q$,
               every axis x label/.style={at={(current axis.right of origin)},anchor=north west},
               width=0.7*\textwidth, height=0.5*\textwidth,
               %y=100pt
              ]
    
    % plots
    \addplot[blue, name path=B,thick] {gauss(x,\B,\Bs)};
    \addplot[black,dashed,thick]
      coordinates {({\B-2*\Bs}, {0.60*gauss(\B,\B,\Bs)}) ({\B-2*\Bs}, \ymin)};
    \addplot[black,dashed,thick]
      coordinates {({\B-1*\Bs}, {0.90*gauss(\B,\B,\Bs)}) ({\B-1*\Bs}, \ymin)};
    \addplot[black,dashed,line width=0.7pt]
      coordinates {(\B, {1.10*gauss(\B,\B,\Bs)}) (\B,\ymin)};
    \addplot[black,dashed,thick]
      coordinates {({\B+1*\Bs}, {0.90*gauss(\B,\B,\Bs)}) ({\B+1*\Bs}, \ymin)};
    \addplot[black,dashed,thick]
      coordinates {({\B+2*\Bs}, {0.60*gauss(\B,\B,\Bs)}) ({\B+2*\Bs}, \ymin)};
    
    \node[above=-2pt] at ({\B-1.5*\Bs},\ymin) {\small$-2\sigma$};
    \node[above=-2pt] at ({\B-0.5*\Bs},\ymin) {\small$-1\sigma$};
    \node[above=-2pt] at ({\B+0.5*\Bs},\ymin) {\small$+1\sigma$};
    \node[above=-2pt] at ({\B+1.5*\Bs},\ymin) {\small$+2\sigma$};
    
    % fill
    \path[name path=xaxis]
      (0,0) -- (\pgfkeysvalueof{/pgfplots/xmax},0); %\pgfkeysvalueof{/pgfplots/xmin}
    \addplot[black!0!yellow] fill between[of=xaxis and B, soft clip={domain={\B-2*\Bs}:{\B+2*\Bs}}];
    \addplot[black!10!green] fill between[of=xaxis and B, soft clip={domain={\B-1*\Bs}:{\B+1*\Bs}}];
    
    % labels
    %\node[above=0pt, black!20!blue] at (\B,{1.05*gauss(\B,\B,\Bs)}) {$f(x|\text{b})$};
    %\node[] at ($(\ymin,0)!0.5!(\ymin,0)$) {$+2\sigma$};
    
  \end{axis}
\end{tikzpicture}



\end{document}
